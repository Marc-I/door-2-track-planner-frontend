<div class="time-selector">
  <h2>Wann musst du spätestens zurück sein?</h2>
  <p class="description">Wir planen deine Aktivitäten so, dass du rechtzeitig zurück bist</p>

  <div class="options">
    <div class="option">
      <mat-radio-group [(ngModel)]="returnType" 
                       (ngModelChange)="handleReturnTypeChange($event)">
        <div class="option-row">
          <mat-radio-button value="today">
            <div class="option-content">
              <mat-icon>schedule</mat-icon>
              <span>Heute zurück</span>
            </div>
          </mat-radio-button>

          <div *ngIf="returnType === 'today'" class="time-picker">
            <mat-form-field appearance="outline">
              <mat-select [(ngModel)]="hours" (selectionChange)="handleTimeChange()">
                <mat-option *ngFor="let hour of hoursOptions" [value]="hour">
                  {{hour}}
                </mat-option>
              </mat-select>
            </mat-form-field>

            <span class="time-separator">:</span>

            <mat-form-field appearance="outline">
              <mat-select [(ngModel)]="minutes" (selectionChange)="handleTimeChange()">
                <mat-option *ngFor="let minute of minutesOptions" [value]="minute">
                  {{minute}}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
        </div>

        <div class="option-row">
          <mat-radio-button value="other">
            <div class="option-content">
              <mat-icon>event</mat-icon>
              <span>Anderes Datum</span>
            </div>
          </mat-radio-button>

          <div *ngIf="returnType === 'other'" class="date-time-picker">
            <mat-form-field appearance="outline" class="date-field">
              <input matInput [matDatepicker]="picker" [(ngModel)]="selectedDate" (dateChange)="handleDateChange()">
              <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
              <mat-datepicker #picker></mat-datepicker>
            </mat-form-field>

            <div class="time-picker">
              <mat-form-field appearance="outline">
                <mat-select [(ngModel)]="hours" (selectionChange)="handleTimeChange()">
                  <mat-option *ngFor="let hour of hoursOptions" [value]="hour">
                    {{hour}}
                  </mat-option>
                </mat-select>
              </mat-form-field>

              <span class="time-separator">:</span>

              <mat-form-field appearance="outline">
                <mat-select [(ngModel)]="minutes" (selectionChange)="handleTimeChange()">
                  <mat-option *ngFor="let minute of minutesOptions" [value]="minute">
                    {{minute}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </div>
          </div>
        </div>
      </mat-radio-group>
    </div>
  </div>

  <div class="return-time">
    <mat-icon>schedule</mat-icon>
    <div class="return-time-content">
      <h3>Deine Rückkehrzeit</h3>
      <p>{{getReturnTimeDisplay()}}</p>
    </div>
  </div>

  <div class="card-actions">
    <button mat-flat-button color="primary" routerLink="/">
      <mat-icon>arrow_back</mat-icon>
      Zurück
    </button>
    <button mat-flat-button color="primary" routerLink="/activities" [disabled]="!hasReturnTime">
      Weiter
      <mat-icon>arrow_forward</mat-icon>
    </button>
  </div>
</div>
